version: '3.8'

services:
  # PostgreSQL MCP Server (connects to external PostgreSQL)
  postgresql-mcp-server:
    build: .
    container_name: postgresql-mcp-server
    environment:
      # Configure these to connect to your external PostgreSQL
      POSTGRES_HOST: ${POSTGRES_HOST:-host.docker.internal}
      POSTGRES_PORT: ${POSTGRES_PORT:-5432}
      POSTGRES_DB: ${POSTGRES_DB:-postgres}
      POSTGRES_USER: ${POSTGRES_USER:-postgres}
      POSTGRES_PASSWORD: ${POSTGRES_PASSWORD:-changeme}
      POSTGRES_READONLY: ${POSTGRES_READONLY:-false}
      POSTGRES_SSLMODE: ${POSTGRES_SSLMODE:-prefer}
      
      # Connection pool settings
      POSTGRES_POOL_MIN: ${POSTGRES_POOL_MIN:-1}
      POSTGRES_POOL_MAX: ${POSTGRES_POOL_MAX:-10}
      QUERY_TIMEOUT: ${QUERY_TIMEOUT:-30}
    stdin_open: true  # Keep stdin open for MCP communication
    tty: true
    # Use host network mode to access host's PostgreSQL
    # Uncomment the following line if your PostgreSQL runs on the host
    # network_mode: "host"


